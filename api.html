
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>API &#8212; tomojs-pytools  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Development" href="development.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="development.html" title="Development"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tomojs-pytools  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">API</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-pytools.meta">
<span id="api"></span><h1>API<a class="headerlink" href="#module-pytools.meta" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="pytools.meta.is_int16">
<span class="sig-prename descclassname"><span class="pre">pytools.meta.</span></span><span class="sig-name descname"><span class="pre">is_int16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#pytools.meta.is_int16" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an image file header to inspect meta-data.</p>
<p>Supported file formats include TIFF, and others supported by SimpleITK and the Insight toolkit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> – The path to an image file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the pixel type is a signed 16-bit integer, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-pytools.utils.zarr"></span><dl class="py function">
<dt class="sig sig-object py" id="pytools.utils.zarr.bin_shrink">
<span class="sig-prename descclassname"><span class="pre">pytools.utils.zarr.</span></span><span class="sig-name descname"><span class="pre">bin_shrink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.utils.zarr.bin_shrink" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces image by a factor of 2 in xyz and performs averaging.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> – an array-like object of 3 dimensions</p></li>
<li><p><strong>shrink_dim</strong> – an iterable for dimensions to perform operation on. Recommended to order from the fastest axis to
slowest for performance.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytools.utils.zarr.build_pyramid">
<span class="sig-prename descclassname"><span class="pre">pytools.utils.zarr.</span></span><span class="sig-name descname"><span class="pre">build_pyramid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zarr_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-1,</span> <span class="pre">-2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.utils.zarr.build_pyramid" title="Permalink to this definition">¶</a></dt>
<dd><p>Iteratively generate multiple resolutions of zarr arrays.</p>
<p>The input array is named by the first items in the components. The remaining components are iteratively generated by
reducing the resolution in the “shrink” dimensions, by a factor of 2.</p>
</dd></dl>

<span class="target" id="module-pytools.convert"></span><dl class="py function">
<dt class="sig sig-object py" id="pytools.convert.file_to_uint8">
<span class="sig-prename descclassname"><span class="pre">pytools.convert.</span></span><span class="sig-name descname"><span class="pre">file_to_uint8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#pytools.convert.file_to_uint8" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an image file, scale the input pixel intensity range to 0-255, and write an image as an unsigned 8-bit integer.</p>
<p>Supported file formats include TIFF, and others supported by SimpleITK and the Insight toolkit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_file_path</strong> – The file path for the source image.</p></li>
<li><p><strong>out_file_path</strong> – The file path to the output, the extension will be used to automatically determine the Image
format used. The out_file_path must be different that the input_file_path.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The conversion from to uint16 is done with floating point operations with truncation rounding. This is
considered an implementation detail that may change.</p>
</div>
</dd></dl>

<span class="target" id="module-pytools.ng.mrc2nifti"></span><dl class="py function">
<dt class="sig sig-object py" id="pytools.ng.mrc2nifti.sub_volume_execute">
<span class="sig-prename descclassname"><span class="pre">pytools.ng.mrc2nifti.</span></span><span class="sig-name descname"><span class="pre">sub_volume_execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.ng.mrc2nifti.sub_volume_execute" title="Permalink to this definition">¶</a></dt>
<dd><p>A function decorator which executes func on each sub-volume and <em>in-place</em> pastes the output input the
input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inplace</strong> – </p></li>
<li><p><strong>func</strong> – A function which take a SimpleITK Image as it’s first argument and returns the results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A wrapped function.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-pytools.ng.build_histogram"></span><dl class="py class">
<dt class="sig sig-object py" id="pytools.ng.build_histogram.HistogramBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytools.ng.build_histogram.</span></span><span class="sig-name descname"><span class="pre">HistogramBase</span></span><a class="headerlink" href="#pytools.ng.build_histogram.HistogramBase" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytools.ng.build_histogram.histogram_robust_stats">
<span class="sig-prename descclassname"><span class="pre">pytools.ng.build_histogram.</span></span><span class="sig-name descname"><span class="pre">histogram_robust_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_edges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.ng.build_histogram.histogram_robust_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the “median” and “mad” (Median Absolute Deviation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist</strong> – The histogram weights ( density or count ).</p></li>
<li><p><strong>bin_edges</strong> – The edges of the bins. This array should be one greater than the hist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytools.ng.build_histogram.histogram_stats">
<span class="sig-prename descclassname"><span class="pre">pytools.ng.build_histogram.</span></span><span class="sig-name descname"><span class="pre">histogram_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_edges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.ng.build_histogram.histogram_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the “mean”, “var” (variance), and “sigma” (standard deviation) from the provided histogram.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hist</strong> – The histogram weights ( density or count ).</p></li>
<li><p><strong>bin_edges</strong> – The edges of the bins. This array should be one greater than the hist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytools.ng.build_histogram.sitkHistogramHelper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytools.ng.build_histogram.</span></span><span class="sig-name descname"><span class="pre">sitkHistogramHelper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.ng.build_histogram.sitkHistogramHelper" title="Permalink to this definition">¶</a></dt>
<dd><p>Read image slice by slice, and build a histogram. The image file must be readable by SimpleITK.
The SimpleITK is expected to support streaming the file format.</p>
<p>The np.histogram function is run on each image slice with the provided histogram_bin_edges, and
accumulated for the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – The path to the image file to read. MRC file type is recommend.</p></li>
<li><p><strong>histogram_bin_edges</strong> – A monotonically increasing array of min edges. The resulting
histogram or weights will have n-1 elements. If None, then it will be automatically computed for integers, and
an np.bincount may be used as an optimization.</p></li>
<li><p><strong>extract_axis</strong> – The image dimension which is sliced during image reading.</p></li>
<li><p><strong>density</strong> – If true the sum of the results is 1.0, otherwise it is the count of values in each bin.</p></li>
<li><p><strong>extract_step</strong> – The number of slices to read at one time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytools.ng.build_histogram.stream_build_histogram">
<span class="sig-prename descclassname"><span class="pre">pytools.ng.build_histogram.</span></span><span class="sig-name descname"><span class="pre">stream_build_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">histogram_bin_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.ng.build_histogram.stream_build_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Read image slice by slice, and build a histogram. The image file must be readable by SimpleITK.
The SimpleITK is expected to support streaming the file format.
The np.histogram function is run on each image slice with the provided histogram_bin_edges, and
accumulated for the results.
:param  filename: The path to the image file to read. MRC file type is recommend.
:param histogram_bin_edges: A monotonically increasing array of min edges. The resulting</p>
<blockquote>
<div><p>histogram or weights will have n-1 elements. If None, then it will be automatically computed for integers, and
an np.bincount may be used as an optimization.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>extract_axis</strong> – The image dimension which is sliced during image reading.</p></li>
<li><p><strong>density</strong> – If true the sum of the results is 1.0, otherwise it is the count of values in each bin.</p></li>
<li><p><strong>extract_step</strong> – The number of slices to read at one time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytools.ng.build_histogram.weighted_quantile">
<span class="sig-prename descclassname"><span class="pre">pytools.ng.build_histogram.</span></span><span class="sig-name descname"><span class="pre">weighted_quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.ng.build_histogram.weighted_quantile" title="Permalink to this definition">¶</a></dt>
<dd><p>Very close to numpy.percentile, but supports weights.
NOTE: quantiles should be in [0, 1]!
:param values: numpy.array with data
:param quantiles: array-like with many quantiles needed
:param sample_weight: array-like of the same length as <cite>array</cite>
:param values_sorted: bool, if True, then will avoid sorting of
initial array
:param old_style: if True, will correct output to be consistent
with numpy.percentile.
:return: numpy.array with computed quantiles.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytools.ng.build_histogram.zarrHisogramHelper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytools.ng.build_histogram.</span></span><span class="sig-name descname"><span class="pre">zarrHisogramHelper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytools.ng.build_histogram.zarrHisogramHelper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<span class="target" id="module-pytools.zarr_rechunk"></span><span class="target" id="module-pytools.zarr_build_multiscales"></span></section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">API</a><ul>
<li><a class="reference internal" href="#pytools.meta.is_int16"><code class="docutils literal notranslate"><span class="pre">is_int16()</span></code></a></li>
<li><a class="reference internal" href="#pytools.utils.zarr.bin_shrink"><code class="docutils literal notranslate"><span class="pre">bin_shrink()</span></code></a></li>
<li><a class="reference internal" href="#pytools.utils.zarr.build_pyramid"><code class="docutils literal notranslate"><span class="pre">build_pyramid()</span></code></a></li>
<li><a class="reference internal" href="#pytools.convert.file_to_uint8"><code class="docutils literal notranslate"><span class="pre">file_to_uint8()</span></code></a></li>
<li><a class="reference internal" href="#pytools.ng.mrc2nifti.sub_volume_execute"><code class="docutils literal notranslate"><span class="pre">sub_volume_execute()</span></code></a></li>
<li><a class="reference internal" href="#pytools.ng.build_histogram.HistogramBase"><code class="docutils literal notranslate"><span class="pre">HistogramBase</span></code></a></li>
<li><a class="reference internal" href="#pytools.ng.build_histogram.histogram_robust_stats"><code class="docutils literal notranslate"><span class="pre">histogram_robust_stats()</span></code></a></li>
<li><a class="reference internal" href="#pytools.ng.build_histogram.histogram_stats"><code class="docutils literal notranslate"><span class="pre">histogram_stats()</span></code></a></li>
<li><a class="reference internal" href="#pytools.ng.build_histogram.sitkHistogramHelper"><code class="docutils literal notranslate"><span class="pre">sitkHistogramHelper</span></code></a></li>
<li><a class="reference internal" href="#pytools.ng.build_histogram.stream_build_histogram"><code class="docutils literal notranslate"><span class="pre">stream_build_histogram()</span></code></a></li>
<li><a class="reference internal" href="#pytools.ng.build_histogram.weighted_quantile"><code class="docutils literal notranslate"><span class="pre">weighted_quantile()</span></code></a></li>
<li><a class="reference internal" href="#pytools.ng.build_histogram.zarrHisogramHelper"><code class="docutils literal notranslate"><span class="pre">zarrHisogramHelper</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="development.html"
                          title="previous chapter">Development</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/api.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="development.html" title="Development"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tomojs-pytools  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">API</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, Bradley Lowekamp.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
  </body>
</html>